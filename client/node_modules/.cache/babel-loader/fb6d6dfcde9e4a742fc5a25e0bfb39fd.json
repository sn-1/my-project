{"ast":null,"code":"import _objectSpread from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/sanjidanawrin/n3/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import FullCalendar from\"@fullcalendar/react\";import dayGridPlugin from\"@fullcalendar/daygrid\";import timeGridPlugin from\"@fullcalendar/timegrid\";import interactionPlugin from\"@fullcalendar/interaction\";import TripForm from\"components/FormModal\";import TripCard from\"components/TripCard\";import\"./main.scss\";import axios from\"../../utils/API\";import moment from\"moment-timezone\";var DemoApp=/*#__PURE__*/function(_React$Component){_inherits(DemoApp,_React$Component);function DemoApp(){var _getPrototypeOf2;var _this;_classCallCheck(this,DemoApp);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(DemoApp)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.calendarComponentRef=React.createRef();_this.state={calendarWeekends:true,eventSources:[],id:\"\",title:\"\",location:\"\",start:new Date(),end:new Date(),description:\"\",showModal:false,errorTitle:\"\",errorLocation:\"\",errorStart:\"\",errorEnd:\"\",errorDescription:\"\",showCard:false,users:[],guests:[]};_this.handleEventClick=function(event){// get the trip's id from database\n_this.setState({showCard:true});_this.handleTrip(event.event.extendedProps._id);};_this.handleDeleteClick=function(){_this.setState({showCard:false});_this.handleDeleteTrip(_this.state.id);};_this.handleUpdateClick=function(){if(_this.state.title&&_this.state.start&&_this.state.end&&_this.state.description){_this.setState({showCard:false});_this.handleUpdateTrip(_this.state.id);_this.setState({errorTitle:\"\",errorLocation:\"\",errorStart:\"\",errorEnd:\"\",errorDescription:\"\"});}else{_this.setState({errorTitle:\"*Please enter your trip name\",errorLocation:\"*Please enter your trip location\",errorStart:\"*Please enter the start date\",errorEnd:\"*Please enter the end date\",errorDescription:\"*Please enter the description\"});}};_this.handleTrip=function(id){axios.getOneTrip(id).then(function(res){var dateStart=res.data.start;var start=moment(dateStart).tz(\"UTC\").format('YYYY-MM-DD');var dateEnd=res.data.end;var end=moment(dateEnd).tz(\"UTC\").format('YYYY-MM-DD');_this.setState({id:res.data._id,title:res.data.title,location:res.data.location,start:start,end:end,description:res.data.description,guests:res.data.guests});}).catch(function(err){return console.log(err);});};_this.handleDeleteTrip=function(id){axios.deleteTrip(id).then(function(){_this.refreshTrips();}).catch(function(err){return console.log(err);});};_this.handleUpdateTrip=function(id){// console.log(this.state);\naxios.update(id,_this.state).then(function(res){_this.refreshTrips();}).catch(function(err){return console.log(err);});};_this.handleInputChange=function(event){// Getting the value and name of the input which triggered the change\nvar value=event.target.value;var name=event.target.name;// Updating the input's state\n_this.setState(_defineProperty({},name,value));};_this.toggleWeekends=function(){_this.setState({// update a property\ncalendarWeekends:!_this.state.calendarWeekends});};_this.gotoPast=function(){var calendarApi=_this.calendarComponentRef.current.getApi();calendarApi.gotoDate(\"2000-01-01\");// call a method on the Calendar object\n};_this.handleCloseClick=function(){_this.setState({showModal:false,showCard:false,errorTitle:\"\",errorStart:\"\",errorLocation:\"\",errorEnd:\"\",errorDescription:\"\"});};_this.handleDateClick=function(){_this.setState({// startDate: new Date(arg.date),\nshowModal:true,title:\"\",location:\"\",start:new Date().getUTCHours(),end:new Date().getUTCHours(),description:\"\"});};_this.handleGuestsChange=function(event){//Can't do filter and map on HTMLCollections\nvar asArr=Array.prototype.slice.call(event.target.options);var guestIds=asArr.filter(function(option){return option.selected;}).map(function(option){return option.value;});_this.setState({guests:guestIds});};_this.handleSaveTrip=function(){if(_this.state.title&&_this.state.start&&_this.state.end&&_this.state.description){axios.saveTrip(_this.state).then(function(){_this.refreshTrips();_this.setState({showModal:false});}).catch(function(err){return console.log(err);});_this.setState({title:\"\",location:\"\",start:new Date().getUTCHours(),end:new Date().getUTCHours(),description:\"\",errorTitle:\"\",errorLocation:\"\",errorStart:\"\",errorEnd:\"\",errorDescription:\"\",guests:[]});}else{_this.setState({errorTitle:\"*Please enter your trip name\",errorLocation:\"*Please enter your trip location\",errorStart:\"*Please enter the start date\",errorEnd:\"*Please enter the end date\",errorDescription:\"*Please enter the description\"});}};return _this;}_createClass(DemoApp,[{key:\"componentDidMount\",value:function componentDidMount(){this.refreshTrips();this.getAllUsers();}// get all users for guests list\n},{key:\"getAllUsers\",value:function getAllUsers(){var _this2=this;axios.getAllUsers().then(function(resp){_this2.setState({users:resp.data});});}// display trip on calendar\n},{key:\"refreshTrips\",value:function refreshTrips(){var _this3=this;axios.getTrips().then(function(resp){_this3.setState({eventSources:resp.data[0].trip.map(function(e){var start=moment(e.start).tz('UTC').format('YYYY-MM-DD');var end=moment(e.end).tz('UTC').add(1,'days').format('YYYY-MM-DD');return _objectSpread({},e,{start:start,end:end});})});});}},{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"demo-app\"},React.createElement(TripForm,Object.assign({show:this.state.showModal},this.state,{close:this.handleCloseClick,save:this.handleSaveTrip,handleInputChange:this.handleInputChange,handleGuestsChange:this.handleGuestsChange})),React.createElement(TripCard,Object.assign({show:this.state.showCard},this.state,{close:this.handleCloseClick,delete:this.handleDeleteClick,save:this.handleUpdateClick,handleInputChange:this.handleInputChange,handleGuestsChange:this.handleGuestsChange})),React.createElement(\"div\",{className:\"demo-app-top mb-4\"},React.createElement(\"button\",{onClick:this.toggleWeekends,className:\"btn btn-dark\"},\"toggle weekends\"),\"\\xA0\",React.createElement(\"button\",{onClick:this.gotoPast,className:\"btn btn-dark\"},\"go to a date in the past\"),\"\\xA0 (also, click a date/time to add an event)\"),React.createElement(\"div\",{className:\"demo-app-calendar\"},React.createElement(FullCalendar,{defaultView:\"dayGridMonth\",header:{left:\"prev,next today\",center:\"title\",right:\"dayGridMonth,timeGridWeek,timeGridDay,listWeek\"},plugins:[dayGridPlugin,timeGridPlugin,interactionPlugin],ref:this.calendarComponentRef,weekends:this.state.calendarWeekends,events:this.state.eventSources,dateClick:this.handleDateClick,eventClick:this.handleEventClick})));}}]);return DemoApp;}(React.Component);export{DemoApp as default};","map":{"version":3,"sources":["/Users/sanjidanawrin/n3/client/src/components/calendar/index.js"],"names":["React","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","TripForm","TripCard","axios","moment","DemoApp","calendarComponentRef","createRef","state","calendarWeekends","eventSources","id","title","location","start","Date","end","description","showModal","errorTitle","errorLocation","errorStart","errorEnd","errorDescription","showCard","users","guests","handleEventClick","event","setState","handleTrip","extendedProps","_id","handleDeleteClick","handleDeleteTrip","handleUpdateClick","handleUpdateTrip","getOneTrip","then","res","dateStart","data","tz","format","dateEnd","catch","err","console","log","deleteTrip","refreshTrips","update","handleInputChange","value","target","name","toggleWeekends","gotoPast","calendarApi","current","getApi","gotoDate","handleCloseClick","handleDateClick","getUTCHours","handleGuestsChange","asArr","Array","prototype","slice","call","options","guestIds","filter","option","selected","map","handleSaveTrip","saveTrip","getAllUsers","resp","getTrips","trip","e","add","left","center","right","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport TripForm from \"components/FormModal\";\nimport TripCard from \"components/TripCard\";\nimport \"./main.scss\";\nimport axios from \"../../utils/API\";\nimport moment from \"moment-timezone\";\n\nexport default class DemoApp extends React.Component {\n  componentDidMount() {\n    this.refreshTrips();\n    this.getAllUsers();\n  }\n\n  // get all users for guests list\n  getAllUsers() {\n    axios.getAllUsers().then(resp => {\n      this.setState({\n        users: resp.data\n      });\n    });\n  }\n\n  // display trip on calendar\n  refreshTrips() {\n    axios.getTrips().then(resp => {\n      this.setState(\n        {\n          eventSources: resp.data[0].trip.map(e => {\n            let start = moment(e.start).tz('UTC').format('YYYY-MM-DD');\n            let end = moment(e.end).tz('UTC').add(1, 'days').format('YYYY-MM-DD');\n            return {\n              ...e,\n              start: start,\n              end: end\n            };\n          })\n        });\n    });\n  }\n\n  calendarComponentRef = React.createRef();\n  state = {\n    calendarWeekends: true,\n    eventSources: [],\n    id: \"\",\n    title: \"\",\n    location: \"\",\n    start: new Date(),\n    end: new Date(),\n    description: \"\",\n    showModal: false,\n    errorTitle: \"\",\n    errorLocation: \"\",\n    errorStart: \"\",\n    errorEnd: \"\",\n    errorDescription: \"\",\n    showCard: false,\n    users: [],\n    guests: []    \n  }\n\n  // show trip card\n  handleEventClick = (event) => {\n    // get the trip's id from database\n    this.setState({\n      showCard: true\n    })\n    this.handleTrip(event.event.extendedProps._id)\n  }\n\n  // trip's delete button\n  handleDeleteClick = () => {\n    this.setState({\n      showCard: false\n    })\n    this.handleDeleteTrip(this.state.id)\n  }\n\n  // trip's save changes button\n  handleUpdateClick = () => {\n    if (\n      this.state.title &&\n      this.state.start &&\n      this.state.end &&\n      this.state.description\n      ) {\n        this.setState({\n          showCard: false\n        })\n        this.handleUpdateTrip(this.state.id)\n        this.setState({\n          errorTitle: \"\",\n          errorLocation: \"\",\n          errorStart: \"\",\n          errorEnd: \"\",\n          errorDescription: \"\",\n        })\n      } else {\n        this.setState({\n          errorTitle: \"*Please enter your trip name\",\n          errorLocation: \"*Please enter your trip location\",\n          errorStart: \"*Please enter the start date\",\n          errorEnd: \"*Please enter the end date\",\n          errorDescription: \"*Please enter the description\"\n        });\n      }\n  };\n\n  // get trip's data from database\n  handleTrip = (id) => {\n    axios.getOneTrip(id)\n    .then(res => {\n      const dateStart = res.data.start;\n      const start = moment(dateStart).tz(\"UTC\").format('YYYY-MM-DD');\n      const dateEnd = res.data.end;\n      const end = moment(dateEnd).tz(\"UTC\").format('YYYY-MM-DD');\n      this.setState({\n        id: res.data._id,\n        title: res.data.title,\n        location: res.data.location,\n        start: start,\n        end: end,\n        description: res.data.description,\n        guests: res.data.guests\n      })\n    })\n    .catch(err => console.log(err));\n  }\n\n  // delete a trip\n  handleDeleteTrip = (id) => {\n    axios.deleteTrip(id)\n    .then(() => {\n      this.refreshTrips();\n    })\n  .catch(err => console.log(err));\n\n  }\n\n  // update a trip\n  handleUpdateTrip = (id) => {\n    // console.log(this.state);\n    axios.update(id, this.state)\n    .then(res => {\n      this.refreshTrips();\n    })\n    .catch(err => console.log(err));\n  }\n \n  handleInputChange = event => {\n    // Getting the value and name of the input which triggered the change\n    let value = event.target.value;\n    const name = event.target.name;\n    // Updating the input's state\n    this.setState({\n      [name]: value\n    });\n  };\n\n  toggleWeekends = () => {\n    this.setState({\n      // update a property\n      calendarWeekends: !this.state.calendarWeekends\n    });\n  };\n\n  gotoPast = () => {\n    let calendarApi = this.calendarComponentRef.current.getApi();\n    calendarApi.gotoDate(\"2000-01-01\"); // call a method on the Calendar object\n  };\n\n  // close modal and clear input\n  handleCloseClick = () => {\n    this.setState({\n      showModal: false,\n      showCard: false,\n      errorTitle: \"\",\n      errorStart: \"\",\n      errorLocation: \"\",\n      errorEnd: \"\",\n      errorDescription: \"\"\n    });\n  };\n\n  // click calendar\n  handleDateClick = () => {\n    this.setState({\n      // startDate: new Date(arg.date),\n      showModal: true,\n      title: \"\",\n      location:\"\",\n      start: new Date().getUTCHours(),\n      end: new Date().getUTCHours(),\n      description: \"\"\n    })\n  };\n\n  // guests list\n  handleGuestsChange = (event) => {\n    //Can't do filter and map on HTMLCollections\n    let asArr = Array.prototype.slice.call(event.target.options);\n    let guestIds = asArr\n      .filter(option => option.selected)\n      .map(option => option.value);\n\n    this.setState({\n      guests: guestIds\n    })\n  }\n\n  // save a new trip\n  handleSaveTrip = () => {\n    if (\n      this.state.title &&\n      this.state.start &&\n      this.state.end &&\n      this.state.description\n    ) {\n      axios\n        .saveTrip(this.state)\n        .then(() => {\n          this.refreshTrips();\n          this.setState({\n            showModal: false\n          });\n        })\n        .catch(err => console.log(err));\n      this.setState({\n        title: \"\",\n        location:\"\",\n        start: new Date().getUTCHours(),\n        end: new Date().getUTCHours(),\n        description: \"\",\n        errorTitle: \"\",\n        errorLocation: \"\",\n        errorStart: \"\",\n        errorEnd: \"\",\n        errorDescription: \"\",\n        guests: [],\n      });\n    } else {\n      this.setState({\n        errorTitle: \"*Please enter your trip name\",\n        errorLocation: \"*Please enter your trip location\",\n        errorStart: \"*Please enter the start date\",\n        errorEnd: \"*Please enter the end date\",\n        errorDescription: \"*Please enter the description\"\n      });\n    }\n  };\n  render() {\n    return (\n      <div className='demo-app'>\n        <TripForm show={this.state.showModal}\n        {...this.state}\n        close={this.handleCloseClick} \n        save={this.handleSaveTrip}  \n        handleInputChange={this.handleInputChange}\n        handleGuestsChange={this.handleGuestsChange} />\n        <TripCard show={this.state.showCard}\n        {...this.state}\n        close={this.handleCloseClick}\n        delete={this.handleDeleteClick}\n        save={this.handleUpdateClick}\n        handleInputChange={this.handleInputChange}\n        handleGuestsChange={this.handleGuestsChange} />\n        <div className='demo-app-top mb-4'>\n          <button onClick={this.toggleWeekends} className=\"btn btn-dark\">toggle weekends</button>&nbsp;\n          <button onClick={this.gotoPast} className=\"btn btn-dark\">go to a date in the past</button>&nbsp;\n          (also, click a date/time to add an event)\n        </div>\n        <div className=\"demo-app-calendar\">\n          <FullCalendar\n            defaultView=\"dayGridMonth\"\n            header={{\n              left: \"prev,next today\",\n              center: \"title\",\n              right: \"dayGridMonth,timeGridWeek,timeGridDay,listWeek\"\n            }}\n            plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n            ref={this.calendarComponentRef}\n            weekends={this.state.calendarWeekends}\n            events={this.state.eventSources}\n            dateClick={this.handleDateClick}\n            eventClick={this.handleEventClick}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}